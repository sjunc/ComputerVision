# ComputerVision
## 2주차 
### 컴퓨터 비전의 역사, 실습 환경 구성
영상처리(보정)  
컴퓨터 비전(인식)  
### 인간의 시각  
인간의 시각은 오감 중에서 가장 뛰어남(대역폭이 가장 넓음)  
분류, 검출, 분할, 추적, 행동 분석에 능숙함  
3차원 복원 능력이 있음(2차원 인식-3차원 복원)    
빠르고 강건함  
다른 지능 요소인 지식 표현, 추론, 계획과 협동함(의사결정)  
사전 행동(proactive 일이 일어나기 전에 예측)에 능숙함(사후 행동: reactive 일이 일어난 후에 인지)  
과업 전환(Task Switching)이 매끄럽고 유기적이고 빠름  
비주얼 서보잉(Visual Servoing 시각적인 정보를 실시간으로 반영해 움직임을 정밀제어하는 기술)이 뛰어남  
**한계**  
착시가 있음  
정밀 측정에 오차가 있음  
시야가 한정됨    
피로해지고 퇴화함  
### 영상처리 (Image Processing)
  
 입출력이 영상인 모든 형태의 정보 처리  
 목적하는 정보를 얻기 위해 영상 데이터를 취득하고 이를 가공, 처리, 해석하는 일련의 과정  
(디지털) 영상 처리(Digital Image Processing)  
 디지털 영상을 처리하는 학문  
과거 현재
특수 목적으로 사용 일상적으로 사용

| 과거 | 현재 |
|------|---|
|특수 목적으로 사용 | 일상적으로 사용 |
|군사용, 공업용 | 엔터테인먼트, 디자인, 지문 인식, 얼굴 인식|
  
디지털 영상의 특성  
디지털 데이터 값이 명확하여 아날로그보다 안정적인 영상을 얻을 수 있음  
컴퓨터 기술이 발전하면 기술을 그대로 반영할 수 있음  
디지털 데이터 처리 방법을 활용할 수 있음  
안정적인 디지털 데이터 저장 장치에 영구적으로 저장할 수 있음  
복제 및 전송이 용이함  

디지털 영상 처리 기술의 분야
|기술 분야| 요약|
|------|---|
|디지털 영상 개선 |영상의 화질을 주관적으로 향상시키는 기술(밝기, 업스케일링: 인간에 눈에 좋게)|
|디지털 영상 복원 |손상된 영상을 원본 영상과 가깝게 복원시키는 기술(원본(정답)이 존재 객관적 향상|
|디지털 영상 변환 |디지털 영상을 다른 형태의 데이터로 변환하는 작업|
디지털 영상 분석 |디지털 영상으로부터 원하는 정보를 추출하는 작업|
|디지털 영상 압축|영상을 효율적으로 저장하고 전송하기 위해 불필요하거나 중복된 부분을 제거하는 작업|  
   
디지털 영상 개선   
영상의 화질을 주관적으로 향상시키는 기술  
밝기(0~255)  
x) 너무 어둡거나 밝은 영상 -> 명암 대비 조정  
어두운 곳은 더 어둡게, 밝은 곳은 더 밝게  
한쪽으로 몰려있던 히스토그램(분포)을 길게 늘림  
ex) 잡음(noise)이 많은 영상 -> 잡음 제거 알고리즘 사용  
까만, 하얀 점 잡음(소금, 후추 잡음 salt & pepper noise)  
잡음이 주변과 섞이게 평균을 적용(0검은색,255흰색을 평균으로)    
   
취득한 영상을 보기 좋은 화질로 변환하는 기술이므로, 결과물이 취득 당시의 실제 신호와 다를 수 있음  
객관적으로 원래 신호를 복원하는 기술? No. 이것은 영상 복원 기술  
휴먼 팩터를 고려하여(주관적으로) 좋은 화질로 변환하는 기술    
*휴먼 팩터(human factor): 상품, 시스템, 절차를 설계할 때 상호 작용하는 인간의 특성을 고려하는 설계와 방법론   

디지털 영상 복원(Restoration)  
손상된 영상을 원본 이미지로 되돌리는 것  
카메라 결함이나 저장/전송 실패 등으로 데이터가 훼손될 수 있음   
복원된 영상이 원본에 가까운 값을 가질수록 복원이 잘 된 영상임  
즉, 객관적인 화질 향상 기술  
객관적이므로(휴먼 팩터를 고려하지 않으므로) 주관적 화질 개선을 보장하진 않음  
데이터의 훼손 원인을 찾는 것이 중요함  
훼손 원인을 찾아 모델링한 뒤 역변환하는 방식을 사용할 수 있기 때문  
  
디지털 영상 변환(Transformation)  
 디지털 영상을 다른 형태의 데이터로 변환하는 작업  
 ex) Fourier 변환: [밝기, 색 성분의 강도] -> [주파수]   
푸리에 변환으로 주파수 감지, 발견한 주파수로 규칙적인 노이즈를 찾아 처리 -> 푸리에 역변환    
  
디지털 영상 분석(Analysis)  
디지털 영상으로부터 원하는 정보를 추출하는 작업  
|구조적 정보| 요약|
|------|---|
|디지털 영상의 구조를 파악하여 표현|디지털 영상의 특성을 수치화하여 표현|
|입력 영상에서 윤곽선을 추출하거나 영역을 분리함|입력 영상의 밝깃값 분포와 평균 값을 구함|
|인간이 직관적으로 이해할 수 있음|인간이 이해하기 어려움|  

   
디지털 영상 압축(Compression)  
효율적으로 저장/전송하기 위해 불필요하거나 중복된 부분을 제거하는 작업  
무손실 압축 기법과 손실 압축 기법으로 분류  
무손실 압축 기법: 압축한 뒤 다시 복원해도 복원 영상이 압축 이전의 원본 영상과 동일함  
손실 압축 기법: 압축한 뒤 다시 복원하면 원본 영상과 다름  
디지털 영상에서의 연산 - 덧셈 1 5 10 20 50 100  
우주 사진에는 기본적으로 noise(무작위, random noise, 더해서 상쇄)가 많이 있는데 같은 물체(같은 위치)를 여러 번 찍어 이미지를 더하면 개선할 수 있음  
  
디지털 영상에서의 연산 - 뺄셈   
두 이미지의 차이 확인 ->차이 극대화  
  
디지털 영상에서의 연산 - 곱셈  
원하는 부분만 보고 싶을 때(ROI(관심있는 영역 Region of Interest) mask를 씌운다.)    
   
디지털 영상에서의 연산 - 평균  
이미지를 뿌옇게 만듦.  
  
### 컴퓨터비전(Computer Vision)   
- 영상처리(Image Processing)  
정의: 영상을 가공하거나 보정하는 기술  
주요 기법: 노이즈 제거, 대비 조절, 색상 변환, 필터링 등  
응용: 의료 영상, 위성사진, 사진 보정  
  
- 컴퓨터비전(Computer Vision)  
정의: 인간의 시각을 흉내내는 컴퓨터 프로그램, 영상을 이해하고 판단하는 기술  
주요 기술: 분류(Classification), 검출(Detection), 분할(Segmentation), 추적(Tracking), 행동  
분석(Action Recognition)  
응용: 자율주행, 얼굴 인식, AR/VR, 스마트 팩토리
입력과 출력의 형태에 따른 학문 분야
| | 입력| | |
|------|----|----|----|
|출력 | |영상|심볼|
| |영상|저수준 영상처리|컴퓨터 그래픽|
| |심볼|고수준 영상처리, 컴퓨터 비전|자연어 처리|  

*심볼(Symbol): 영상이 아닌 다른 차원의 정보  
  
영상 -> 영상 : 이미지의 확대/축소  
영상 -> 심볼 : 차량 번호 인식   
심볼 -> 영상 : 코딩으로 애니메이션 생성  
심볼 -> 심볼(영상처리가 아님) : ChatGPT  
   
컴퓨터 비전은 인간의 시각을 흉내 내는 컴퓨터 프로그램
인공지능의 중요한 구성 요소가 됨(자율주행)  
(예) 시각 기능이 있는 로봇은 시각 기능이 없는 로봇보다 더 높은 성능을 보임  
현재 컴퓨터 비전 기술로 인간에 필적하는 시각 구현은 불가능하지만,
"과업을 한정하면" 인간 성능에 가깝거나 뛰어넘도록 활용할 수 있음  
=한가지 일만 시키면  
**응용 사례** 
1. 과일 수확 드론 2. 혈관 분할(CT촬영 조제) 3. 자율 주행 4. 불량 검사 5.선수 행동 분석 6. 고객 동선 분석 7. 얼굴 인식 보안 8. 태양광 모니터링 9. 게임 플레이(알파스타) 10. 지형 모니터링 11. 화성 탐사선 12. 광장 감시 13. 에드몽 벨라미(AI 생성 이미지) 14. 청소 로봇(SLAM: Simultaneous Localizaton And Mapping 3d 지도 맵핑) 15. 휴머노이드 로봇  
컴퓨터 비전이 어려운 이유는 명확함
시각, 시점 등에 따라 시시각각 변하는 물체의 모습
숫자로부터 물체를 인식해야 함
아직 약인공지능(<->강인공지능Strong AI, AGI Artificial General Intelligence)에 머물러있는 인공지능 기술

- 궁극적인 목표  
일반적인 상황에서 잘 작동하는 인간과 같은 시각 (강한 인공지능 AGI)  
영영 불가능하거나 먼 미래에 실현  
- 현실적인 목표  
제한된 환경에서 특정 과업을 높은 성능으로 달성 (약한 인공지능)  
컴퓨터 비전 문제를 여러 세부 문제로 구분하고 세부 문제별로 알고리즘 구상
문제들
분류(classification)  
검출(detection)  
분할(segmentation)  
추적(tracking)  
행동 분석(action analysis)  
### 컴퓨터 비전의 역사
신문 산업에서 태동한 디지털 영상  
1920년 유럽과 북미 간 케이블을 통해 사진 전송하는 Bartlane 시스템 개통  
1946년 세계 최초의 범용 전자식 컴퓨터인 에니악(ENIAC) 탄생  
빠른 계산이 주목적 (에니악은 초당 3000개 가량 덧셈)  
1957년 스캐너를 통해 디지털 영상을 컴퓨터에 저장  
5cmx5cm 사진에서 획득한 176x176 디지털 영상 -> 컴퓨터 비전의 태동  
  
----

## 3주차 OpenCV 실습
### 영상
인간의 눈: 동공 크기를 조절해 장단거리 조절, 인간의 눈엔 상에 맺혀 뉴런을 통해 전달된 걸 통해 이미지를 인식.  
카메라: 빛(밝기)과 색을 받아 센서에서 전기적인 신호로 받아들여 여러 칸으로 나눈 픽셀을 통해 받아들임    

디지털 영상의 획득
sampling: 칸을 얼마나 작게 가져올 것인가  
Quantization: 들어오는 밝기 값과 색상을 얼마나 잘게 가져올 것인가  
  
8페이지 그래프  
밝기 | 0 (검정)  
밝기 | 255 (흰색)  
그래프가 noise가 존재해서 흔들리게 보임  
sampling, Quantization 을 통해 noise 가 없는 경향성을 띄는 부분만 가지고 옴  
continuous → digitized 아날로그 디지털  

### Sampling과 Quantization
이미지를 몇 픽셀로 나타낼 것인가? = Sampling(샘플링)   
이미지의 밝기를 몇 단계로 표현할 것인가? = Quantization(양자화)    
- Sampling  
카메라 센서는 이미지를 격자 모양으로 잘라 저장함.  
얼마나 촘촘하게 자를 것인가를 결정하는 것이 샘플링.   
샘플링 간격이 좁을수록 고해상도 사진이 됨.  
- Quantization(양자화)  
각 픽셀의 색이나 밝기를 얼마나 다양하게 나타낼 것인가를 결정하는 것.   
예: 밝기 단위가 2단계 - 흑백만 있는 이진 이미지.  
밝기의 단계가 많을수록 자연스러운 이미지  
   
Sampling 간격이 좁으면 화질이 높아지고, Quantization level이 높아지면 여러가지 밝기를 표현할 수 있음  
  
컬러의 경우 (R, G, B) 3채널 값을 보여줄 때 겹쳐서 표현  

Quantization   
밝기 레벨의 수: L=2   
즉, 2, 4, 8, 16, ...   
(1레벨: 2가지 흑백 0 1)/(2레벨: 4가지 00 11 01 10)/(3단계: 8가지 001 010 100 011 110 111 000 101)...   
k =  1: binary image(이진), Dynamic range: [0,1]   
k =  8: grayscale image(회색조), Dynamic range: [0,255]    
k =  10: medical image(군사/의료용)   

### 컬러 이미지
Three Shot Color Filter Camera 5X7X3    
Color Mosaic Camera 5X7 이지만 교차시켜서 표현 용량이 작음  

문제   
1. 256개의 밝깃값을 나타내는 카메라에서 512*512 픽셀의 영상을 취득하면 용량은?  
(Three Shot Color Filter Camera인 경우만 생각한다.)  
  
512 * 512 * 8(256개 밝기값) * 3 (RGB 3채널)bit   
   
2. 256개의 밝깃값을 나타내는 카메라에서 512 * 512 픽셀의 30분 흑백(여러 단계가 있어도 흑백: 1레벨 의미 X) 동영상을 취득하면 용량은? 단, 동영상은 60fps이다.   
60(초당 60프레임) * 512 * 512 * 8(256개 밝기 값) * 30(분) * 60(초)  =  

### 영상입출력, 영상변환  

객체지향 특성과 강점  
- 객체는 능동적  
- '.'을 찍어 자신이 가진 함수를 능동적으로 호출할 수 있음.  
- 객체 내부에 있는 함수를 멤버 함수(member function), 또는 메서드(method)라 함.  
- 객체 내부에는 데이터를 저장할 멤버 변수(member variable)도 있음.  
- 필요한 만큼 얼마든지 찍어낼 수 있음  
  
실습
  
opencv 에서 B, G, R 순서  
imread
imwrite
cvtcolor
resize  
dsize  
출력된 이미지 크기 지정, 하라라도 0이면 fx,fy 인자를 비율로 사용함.   
fx = 가로 배율, fy = 세로 배율. 코드에선 1/4 크기가 됨.   

cvtColor 함수가 컬러 영상을 명암 영상으로 바꾸는 방법  
I = round(0.299 X R + 0.587 X G + 0.114 X B)  
109  
 
(실습)영상에 도형 그리고 글자 쓰기   
• OpenCV의 그래픽 기능   
• 영상에 글씨나 도형을 넣는데 유용   
• line(선), rectangle(사각형), polylines(점을 연결하는 선), circle(원), ellipse(타원), putText(글씨 삽입) 함수   
   
opencv (0, 0) (x, y)   
왼쪽 위가 (0,0)   
x는 오른쪽으로 y는 아래쪽으로   

----

## 4주차 영상 처리 
### 01 디지털 영상 02 이진 영상 03 점 연산, 영역 연산, 기하 연산
### cv 
cv 왼쪽 위 좌표 (0, 0)   
OpenCV에서 이미지는 numpy.ndarray 클래스로 표현됨  
그러므로 numpy.ndarray가 지원하는 다양한 함수를 사용할 수 있음   
(예) min, max, argmin, argmax, mean, sort, reshape, transpose, … …    
### 영상 종류  
명암 영상 2차원 텐서     
컬러 영상 3차원 텐서   
컬러 동영상 4차원 텐서 (t 시간 축)   
의료/군사 영상 (다분광/초분광/MR(MRI)/CT 영상) 고차원 텐서  
RGB-D 영상 4차원 텐서 (RGB + D) Depth 가 추가됨. 자율주행(급정거)같은 기술에서 사용  
점 구름 영상 라이다 (LiDAR: Light Detection and Ranging 빛 감지 후 거리 측정)로 획득 깊이 측정(자율주행)  

RGB(빛의 삼원색)  
혼합, RGB 큐브, 양자화된 RGB 큐브(양자화 단계에 따라 다양하게 표현가능)  
CMY( 프린트 색의 삼원색: Cyan, Magenta, Yellow : CMYK+ 검정(Key plate))   
HSV  
H(Hue): 색상, 색의 종류(빨, 파, 초 등)  
S(Saturation): 채도, 색의 선명한 정도(진하기)   
V(Value): 명암, 밝은 정도  
LAB  밝기(Lightness), 적록과 황청(a Channel, b Channel)   

### 이진 영상  
이진 영상(Binary image)  : 화소가 흑(0) 또는 백(1)인 영상  
- 컴퓨터 비전에서는 에지를 검출한 후 에지만 1로 표현하거나, 물체를 검출한 후 물체는 1, 배경은 0으로 표시하는 방식 등으로 이진 영상을 활용함   
- 이론적으로는 한 픽셀(화소)당 1bit면 되지만, 프로그램 편의상 한 픽셀당 1byte를 할당하는 경우가 많음  
ex)밝기값 T 이상일 때 검, 아래일 때 흰   
  
이진 영상을 만드려면 먼저 히스토그램을 획득해야 함  
흑과 백으로 나눌 기준점이 될 임계값 T를 구하고, 그 T보다 높으면 백(1), 낮으면 흑(0)으로 변환  
T값은 히스토그램이 계곡 모양으로 나타나는 부근으로 결정하면 좋음(두 영역이 잘 분리됨)  
T값을 구할 땐 Otsu 알고리즘이 유용함   
            1, f(j,1) >= T  
b(j, i) = {                 (3.1)  
            0, f(j,i) < T  
   
8가지 히스토그램 밝기 값 > 2**3 > 3bit  
계곡 모양 기준으로 나누므로 T = 4  
T 보다 크거나 같을 때 1, 작으면 0 으로 맵핑  
이진 이미지 변경 실습(일반/오츄 알고리즘)  
  
연결성(connectivity)  
: 픽셀들의 이웃과 연결된 영역을 판단하는 기준  
(예) 4-연결성(4-connectivity): 상하좌우 4개의 이웃만 연결된 것으로 간주함  
(예) 8-연결성(8-connectivity): 상하좌우+대각선까지 8개의 이웃이 연결된 것으로 간주함  
  
연결 요소(connected components)   
: 이진 영상에서 1의 값을 가진 연결된 화소의 집합  
즉, 하나의 연결된 물체(객체), 덩어리  
a - 원본  
b - 4연결성으로 찾아서 4개  
c - 8연결성으로 찾아서 3개  

   
모폴로지(morphology) 형태학, 형태 연산  
: 형태를 기반으로 이미지를 처리하는 이미지 처리 영산의 집합  
: 영상의 표현에 유용한 구조와 형태를 추출하는 연산들  
-> 이미지 분할(segmentation), 특징 추출(feature extraction) 등에 사용됨  
기본적으로 침식(Erosion)과 팽창(Dilation) 연산이 있음  
   
구조 요소(Structuring Element)   
: 모폴로지 연산에 사용되는 작은 마스크(커널) 형태의 패턴  
- 모폴로지 연산시 각 픽셀을 돌아다니며 어떻게 판단할지 정하는 기준이 되는 모양    
자유롭게 모양 설정 가능(연결요소와 다른점)  

팽창(dilation)  
: 영역을 키움.  
: 작은 홈을 메우거나 끊어진 영역을 연결하는 효과.(사소한 부분 덮기)  
침식(erosion)  
: 영역을 작게 만듦  
: 경계에 솟은 돌출 부분을 깎아내는 효과.(사소한 부분 지우기)  
열림(opening)  
: 원래 영역 크기를 유지  
: 침식 후 팽창  
닫힘(closing)  
: 원래 영역 크기를 유지  
: 팽창 후 침식  





























